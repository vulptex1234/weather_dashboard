(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7389:function(e,t,a){Promise.resolve().then(a.bind(a,220))},220:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var r=a(7437),s=a(2265),n=a(8336),l=a(6940),i=a(7059),d=a(2994),c=a(8147),o=a(2190),h=a(4061),m=a(3281);function u(e){let{data:t,dataKey:a,title:s}=e,u=t.map(e=>({time:e.japanese_time,dt:e.dt,value:e[a]}));return(0,r.jsxs)("div",{className:"p-4 bg-white rounded-lg shadow",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:s}),(0,r.jsxs)(n.w,{width:800,height:400,data:u,children:[(0,r.jsx)(l.q,{strokeDasharray:"3 3"}),(0,r.jsx)(i.K,{dataKey:"dt",tickFormatter:e=>(0,m.Z)(new Date(1e3*e),"HH:mm"),minTickGap:20}),(0,r.jsx)(d.B,{}),(0,r.jsx)(c.u,{labelFormatter:e=>(0,m.Z)(new Date(1e3*Number(e)),"yyyy/MM/dd HH:mm")}),(0,r.jsx)(o.D,{}),(0,r.jsx)(h.x,{type:"monotone",dataKey:"value",stroke:"#8884d8"})]})]})}let y=(0,a(7557).eI)("https://oshcvkwocgyxszffxubl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9zaGN2a3dvY2d5eHN6ZmZ4dWJsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk3OTIxOTksImV4cCI6MjA2NTM2ODE5OX0.8gYbXILyuQjybu6gPGrQN1UFxFHGDj8rBkzbl3JoSnE");async function x(){try{let{data:e,error:t}=await y.from("weather_data").select("*").order("timestamp",{ascending:!1}).limit(1);if(t)throw console.error("Error fetching weather data:",t),t;if(!e||0===e.length)return null;return e[0]}catch(e){throw console.error("Error in getLatestWeatherData:",e),e}}function f(){let[e,t]=(0,s.useState)(null),[a,n]=(0,s.useState)(!0),[l,i]=(0,s.useState)(null),[d,c]=(0,s.useState)(null),[o,h]=(0,s.useState)(null),[y,f]=(0,s.useState)("");return((0,s.useEffect)(()=>{(async function(){try{n(!0),i(null);let e=await x();if(e)t(e.data),c(new Date(e.timestamp)),h(new Date(new Date(e.timestamp).getTime()+36e5));else{let e=await fetch("/api/weather");if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to fetch weather data")}let a=await e.json();t(a),c(new Date),h(new Date(new Date().getTime()+36e5))}}catch(e){console.error("Error fetching weather data:",e),i(e instanceof Error?e.message:"An error occurred")}finally{n(!1)}})()},[]),(0,s.useEffect)(()=>{if(!o)return;let e=setInterval(()=>{let t=new Date,a=o.getTime()-t.getTime();if(a<=0){clearInterval(e),f("更新中...");return}f("".concat(Math.floor(a/6e4),":").concat(Math.floor(a%6e4/1e3).toString().padStart(2,"0")))},1e3);return()=>clearInterval(e)},[o]),a)?(0,r.jsx)("div",{className:"min-h-screen p-8 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-xl",children:"Loading weather data..."})}):l?(0,r.jsx)("div",{className:"min-h-screen p-8",children:(0,r.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[(0,r.jsx)("strong",{className:"font-bold",children:"Error: "}),(0,r.jsx)("span",{className:"block sm:inline",children:l})]})}):e?(0,r.jsxs)("main",{className:"min-h-screen p-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"天気予報ダッシュボード"}),(0,r.jsxs)("div",{className:"text-gray-600 space-y-2",children:[(0,r.jsxs)("p",{children:["予報期間:"," ",(0,m.Z)(new Date(1e3*e.hourly[0].dt),"yyyy年MM月dd日 HH:mm")," ","〜"," ",(0,m.Z)(new Date(1e3*e.hourly[e.hourly.length-1].dt),"yyyy年MM月dd日 HH:mm")]}),d&&(0,r.jsxs)("p",{children:["最終更新: ",(0,m.Z)(d,"yyyy年MM月dd日 HH:mm:ss")]}),o&&(0,r.jsxs)("p",{children:["次の更新まで: ",y]})]})]}),(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)(u,{data:e.hourly,dataKey:"temp",title:"24時間予報 - 気温"}),(0,r.jsx)(u,{data:e.hourly,dataKey:"humidity",title:"24時間予報 - 湿度"}),(0,r.jsx)(u,{data:e.hourly,dataKey:"wind_speed",title:"24時間予報 - 風速"}),e.minutely&&(0,r.jsx)(u,{data:e.minutely,dataKey:"precipitation",title:"1時間予報 - 降水量"})]})]}):(0,r.jsx)("div",{className:"min-h-screen p-8",children:(0,r.jsx)("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded",children:"No weather data available. Please try again later."})})}}},function(e){e.O(0,[11,971,117,744],function(){return e(e.s=7389)}),_N_E=e.O()}]);